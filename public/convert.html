<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
    <title>Conversión HEIC/JPG/PNG</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <main class="container">
      <a class="back" href="/">&larr; Volver al menú</a>
      <h1>Conversión HEIC ⇄ JPG/PNG</h1>
      <p class="muted">Por lotes con <b>ImageMagick</b>. Controla calidad, metadatos y color de fondo.</p>

      <form id="convert-form">
        <div id="dropzone" class="dropzone">
          <input id="file-input" type="file" name="images" accept="image/*,.heic,.heif" multiple />
          <span>Arrastra imágenes aquí o haz clic para seleccionarlas</span>
        </div>

        <div id="file-list" class="file-list" hidden>
          <div class="file-list__header">
            <b>Archivos seleccionados</b>
            <small id="file-list-summary"></small>
          </div>
          <ul id="file-list-items"></ul>
        </div>

        <div class="options">
          <div class="grid2">
            <div class="field">
              <label for="target">Formato de salida</label>
              <select id="target">
                <option value="jpg">JPG (JPEG)</option>
                <option value="png">PNG</option>
                <option value="heic">HEIC</option>
              </select>
            </div>
            <div class="field">
              <label for="resize">Resize (opcional)</label>
              <input id="resize" type="text" placeholder="Ej: 1600x o 1600x1200" />
            </div>
          </div>

          <div class="conditional" id="jpg-opts" hidden>
            <div class="grid2">
              <div class="field">
                <label for="jpg-quality">Calidad JPG</label>
                <input id="jpg-quality" type="range" min="0" max="100" value="85" />
                <output id="jpg-quality-val">85</output>
              </div>
              <div class="field">
                <label for="bg">Fondo (transparencias → JPG)</label>
                <input id="bg" type="color" value="#ffffff" />
              </div>
            </div>
          </div>

          <div class="conditional" id="png-opts" hidden>
            <div class="field">
              <label for="png-compression">Compresión PNG (0-9)</label>
              <input id="png-compression" type="range" min="0" max="9" value="9" />
              <output id="png-compression-val">9</output>
            </div>
          </div>

          <div class="conditional" id="heic-opts" hidden>
            <div class="grid2">
              <div class="field">
                <label for="heic-quality">Calidad HEIC</label>
                <input id="heic-quality" type="range" min="0" max="100" value="80" />
                <output id="heic-quality-val">80</output>
              </div>
              <div class="row">
                <label><input id="heic-lossless" type="checkbox" /> Lossless (sin pérdida)</label>
              </div>
            </div>
          </div>

          <div class="row">
            <label><input id="strip" type="checkbox" checked /> Quitar metadatos (EXIF/IPTC)</label>
          </div>

          <div class="row">
            <label><input id="zip" type="checkbox" /> Descargar como .zip</label>
          </div>

          <button type="submit" class="btn">Convertir</button>
        </div>
      </form>

      <div id="progress" class="progress" hidden>
        <div class="progress-row">
          <progress id="progress-bar" max="100" value="0"></progress>
          <span id="progress-label">Preparando…</span>
        </div>
      </div>

      <div id="results" class="results"></div>
    </main>

    <script src="convert.js"></script>
  </body>
</html>
